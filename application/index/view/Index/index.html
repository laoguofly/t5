<!DOCTYPE html><html lang="zh-CN">  <head>            <include file="Common/head" />             <include file="Common/Ihead" />     <style>#c2 .h_t{    background-color: #337ab7;    padding: 8px;    line-height: 1.42857143;    vertical-align: top;    border-top: 1px solid #ddd;    text-align: center;    font-weight: bold;    border-radius: 4px;    border-color: #2e6da4;    color:#fff;}#c2 .h_t1{    background-color: #f9f9f9;    padding:10px;    padding-left:20px;    font-weight: bold;    font-size:12px;}#c2 .b {    min-height:20px;}#c2 .b div{    padding:10px;    padding-left:30px;}#attack_t span{    padding:0px 10px;}.Sc span,.Sr span{    color: red;}tr th{   text-align:center;   vertical-align:middle !important;}tr th,tr td{   text-align:center;   vertical-align:middle !important;}.t8 span{   color: red; }.t1{    font-size:12px;}.hong{    color:#c9302c;}.hui{    color:#999999;}.ju{    color: #f90;;}table{    border-left:1px solid #ddd;    border-right:1px solid #ddd;    border-bottom:1px solid #ddd;}td{    padding:3px !important;    height:40px;}.row {    margin-right: 0px;    margin-left: 0px;}.on11{    background-color:#006699;}    </style>  </head>  <body>    <div class="topbar">            <include file="Common/topbar" />     </div>    <div class="header">            <include file="Common/navbar" />     </div>    <div class="main">        <div class="leftNav">             <include file="Common/left" />          </div>         <div class="r_main">             <div class="row" style="padding-bottom:15px;">                <form class="form-horizontal" id="myformkk" action="<php>echo __HOME__</php>/index/ip_select" method="get">                    <div class="col-sm-3">                         <input type="text" name="ip" id="ip" class="form-control" placeholder="ip搜索">                    </div>                    <div class="col-sm-3">                        <button type="submit" class="btn btn-primary">提交</button>                    </div>                </form>             </div>             <!------------n1----------------->              <div class="t110" style="overflow:auto;">                  <table class="table table-striped">                                                 <tr>                     <th >主机</th>                     <th colspan="2" >带宽</th>                     <th colspan="" >状态</th>                     <th colspan="8">频率</th>                     <th colspan="3">连接</th>                     <th  class="cl">策略操作</th>                 </tr>                 <tr>                     <th></th>                     <th>IN</th>                     <th>OUT</th>                     <th></th>                     <th>SYN</th>                     <th>ACK</th>                     <th>UDP</th>                     <th>ICMP</th>                     <th>FRAG</th>                     <th>NonIP</th>                     <th>NewTCP</th>                     <th>NewUDP</th>                     <th>IN</th>                     <th>OUT</th>                     <th>UDP</th>                     <th class="cl"></th>                 </tr>                <volist name="data1['data']" id="data">                <tr>                    <td class="t1 {$data['status']?"status":""} {$data['address']==$ip?"  on11":""}"  value="{$data['address']?$data['address']:" "}">                        {$data['address']?$data['address']:"全部主机"}                    </td>                    <td>{$data.input_bps}</td>                    <td>{$data.output_bps}</td>                    <td>                      <php>                        if($data['status']){                            echo $data['status'];                        }else{                            echo "正常";                        }                                                </php>                    </td>                    <td>{$data.syn_rate}</td>                    <td>{$data.ack_rate}</td>                    <td>{$data.udp_rate}</td>                    <td>{$data.icmp_rate}</td>                    <td>{$data.frag_rate}</td>                    <td>{$data.nonip_rate}</td>                    <td>{$data.new_tcp_rate}</td>                    <td>{$data.new_udp_rate}</td>                    <td>{$data.tcp_conn_in}</td>                    <td>{$data.tcp_conn_out}</td>                    <td>{$data.udp_conn}</td>                    <td class=" t7 cl ">                        <div class="{$display}  {$data['address']?'':'hide'}">                            <div class="sr" style="display:none">                            <div>                                  输入：<span>{$data.input_bps}</span> Mbps / <span>{$data.input_pps}</span> PPS 云防过滤后                                  <span>{$data.input_submit_bps}</span> Mbps/ <span>{$data.input_submit_pps}</span> PPS                            </div>                            <div <php>if(!$data['output_bps']){echo "style='display:none;'" ;}</php> >                                输出：<span>{$data.output_bps}</span> Mbps / <span>{$data.output_pps}</span> PPS 云防过滤后 <span>{$data.output_submit_bps}</span> Mbps/ <span>{$data.output_submit_pps}</span> PPS                            </div>                            </div>                        <div class="btn-group" data-toggle="buttons">                        <select class="form-control execute1 cs11" >                           <option></option>                        <volist name="data['config']" id="d">                        <option value="{$d['id']}"  {$data['config_id'][0]['host_c_id']==$d['id']?"selected":"" }>{$d['name']}</option>                        </volist>                        </select>                        </div>                        <div>                    </td>                </tr>             </volist>             </table>             </div>             <!-------------n1end---------------->          </div>              </div><!-- Large modal --><div class="modal fade bs-example-modal-lg" style="padding-top:30px;" id="c" tabindex="-1" role="dialog" >  <div class="modal-dialog modal-lg">    <div class="modal-content">        <div class="modal-header">            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>            <h4 class="modal-title">配置文件</h4>        </div>        <form class="form-horizontal" id="myform" action="<php>echo __HOME__</php>/Sconfig/update" method="post">        <div class="modal-body">                <div class="form-group">                      <label for="inputtext3"   class="col-sm-2 control-label">主机地址</label>                      <div class="col-sm-10">                         <p class="form-control-static" id="setting_address1"></p>                         <input type="hidden" id="setting_address" name="param_setting_addr"  class="form-control">                         <span  class="sr-only">(不要空白，或者格式不对255.255.255.255)</span>                      </div>                 </div>                                  <div class="form-group" style="display:none;">                      <label for="inputtext3"  class="col-sm-2 control-label">地址前缀</label>                      <div class="col-sm-7">                         <input type="text"  class="form-control" id="prefix"  name="param_prefix"  placeholder="地址前缀" >                      </div>                         <label class="checkbox-inline">                            <input type="checkbox"  name="param_exist" id="exist" value="ON"> 有效                        </label>                        <label class="checkbox-inline">                          <input type="checkbox" id="force_protect" name="param_force_protect" value="ON"> 防御                        </label>                 </div>                 <div class="form-group" style="display:none;">                      <label for="inputtext3" class="col-sm-2 control-label">网关IP地址</label>                      <div class="col-sm-10">                         <input type="text" class="form-control" name="param_gateway_ip" id="gateway_ip"  placeholder="网关IP地址 255.255.255.255">                      </div>                 </div>                 <div class="form-group" style="display:none";>                      <label for="inputtext3" class="col-sm-2 control-label">网关mac地址</label>                      <div class="col-sm-10">                         <input type="text" class="form-control" name="param_gateway_mac" id="gateway_mac"  placeholder="网关mac地址">                      </div>                 </div>                 <div class="form-group" style="display:none">                      <label for="inputtext3" class="col-sm-2 control-label">流量策略</label>                      <div class="col-sm-4">                         <input type="text" class="form-control" name="param_flowlimit_incoming_bps" id="flow_incoming_bps"  placeholder="Mbps">                      </div>                      <div class="col-sm-4">                         <input type="text" class="form-control" name="param_flowlimit_incoming_pps" id="flow_incoming_pps"  placeholder="PPS">                      </div>                 </div>                 <div class="form-group">                      <label for="inputtext3" class="col-sm-2 control-label">操作</label>                      <div class="col-sm-10">                         <label class="checkbox-inline">                            <input type="checkbox" name="param_ignore" id="ignore" value="ON"> 忽略所有流量                        </label>                        <label class="checkbox-inline">                           <input type="checkbox" name="param_forbid" id="forbid" value="ON"> 屏蔽所有流量                        </label>                        <label class="checkbox-inline" style="display:none;">                           <input type="checkbox" id="forbid_overflow" name="param_forbid_overflow" value="ON"> 流量超出屏蔽                        </label>                        <label class="checkbox-inline">                           <input type="checkbox" id="reject_foreign" name="param_reject_foreign_access" value="ON"> 拒绝国外访问                        </label>                      </div>                 </div>                  <h4 style="text-align:center">设置集序号</h4>                <div class="form-group">                      <label for="inputtext3" class="col-sm-2 control-label">防护参数集</label>                      <div class="col-sm-3">                         <input type="text" name="param_param_set" id="param_set"  class="form-control"  placeholder="防护参数集">                      </div>                      <label for="inputtext3" class="col-sm-2 control-label">过滤规则集</label>                      <div class="col-sm-3">                         <input type="text" name="param_filter_set" id="filter_set" class="form-control"  placeholder="过滤规则集">                      </div>                 </div>                 <div class="form-group">                      <label for="inputtext3" class="col-sm-2 control-label">TCP端口集</label>                      <div class="col-sm-3">                         <input type="text" name="param_portpro_set_tcp" id="portpro_set_tcp" class="form-control"  placeholder="TCP端口集">                      </div>                      <label for="inputtext3" class="col-sm-2 control-label">UDP端口集</label>                      <div class="col-sm-3">                         <input type="text" name="param_portpro_set_udp" id="portpro_set_udp" class="form-control"  placeholder="UDP端口集">                      </div>                  </div>                <div style="text-align:center;">                     <div class="t8">                                        </div>                    <img name="a_1" id="a_1" style="margin-top: 20px;" src="<php>echo __ROOT__</php>/common/img/a1.gif"/>                    <div class="img_1"></div>                 </div>                <div>                    <!--防护插件 隐藏掉                    <input name="param_plugin_tcp_0" id="plugin_tcp_0" type="hidden" value="ON">                    <input name="param_plugin_tcp_1" id="plugin_tcp_1" type="hidden" value="ON">                    <input name="param_plugin_tcp_2" id="plugin_tcp_2" type="hidden" value="ON">                    <input name="param_plugin_tcp_3" id="plugin_tcp_3" type="hidden" value="ON">                    <input name="param_plugin_udp_1" id="plugin_udp_1" type="hidden" value="ON">                   -->                 </div>        </div>        <div class="modal-footer">            <button type="button" class="btn btn-default c2_b" data-dismiss="modal">分析</button>            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>            <button type="submit"  class="btn btn-primary">提交</button>        </div>            </form>    </div>  </div></div><!-- Large modal --><!-- Large modal --><div class="modal fade bs-example-modal-lg" style="padding-top:25px;" id="c2" tabindex="-1" role="dialog" >  <div class="modal-dialog modal-lg">    <div class="modal-content">        <div class="modal-header">            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>            <h4 class="modal-title">                分析             </h4>        </div>        <div class="modal-body">            <div class="col-sm-12" style="text-align:center;padding:20px 0px;">                <img id="img1" src="">            </div>            <div class="col-sm-6">                <div class="h_t">防护报告</div>                <div class="h_t1">攻击防护</div>                <div class="b" id="attack_type"> </div>                <div class="h_t1" id="attack_t">屏蔽统计<span><span></div>                <div class="b" id="attack">                 </div>            </div>            <div class="col-sm-6">                <div class="h_t">数据访问</div>                <div class="h_t1">流量分析</div>                <div class="b I_submit" > </div>                <div class="h_t1">连接访问</div>                <div class="b I_rate"> </div>            </div>        </div>        <div class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>        </div>    </div>  </div></div>    <include file="Common/footer" />         <script> $("#myformkk").submit(function(e){ var name = $("#ip").val(); if(/[^\s]/.test(name)){ }else{    e.preventDefault(); }});         if({$data1['level']}==1){    $(".cl").hide();}$(document).ready(function(){  var i_height = window.screen.height;    //$(".t110").height(i_height-205);  $(".t110").animate({scrollTop:$(".on11").offset().top-200},800)});  //隔行变色技巧 $("tr:even").addClass("one");//奇数行  $("tr:odd").addClass("two");//偶数行 //隔行变色     //点击策略     $(".execute1").change(function(){         var data={};        data['id']  = $(this).val();        data['ip'] =  $(this).parents("tr").find(".t1").attr("value");         if(data['id']){        $.post("<php>echo __HOME__</php>/Sconfig/Set_execute",data,function(data1){            //alert(data1);            if(data1){            alert("成功");           window.location.reload();            }            });        }    });     //提交检测    $("#myform").submit(function(e){                   });    //暂时先弄成方法，之后在抽象为类 查看 配置    $(".t1").click(function(){                var addre = $(this).attr("value");        //新建正则表达式        var is_string =/\//;        if(is_string.test(addre)){         window.location.href="./?hostaddr="+addre;          return;        }        //初始化        $("#c :checked").attr('checked', false);        $("#c :text").val("");        $("#setting_address1").html("");        $("#setting_address").val("");                //获取值        var t8 =  $(this).parents("tr").find(".sr").html();         var tt1 =  $(this).parents("tr").find(".tt1").html();         $(".t8").html(t8);        $(".tt2").html(tt1);                var ip = $(this).attr("value");        $("#a_1").show();        var img =preloader("<php>echo __HOME__ ;</php>/index/Rimg?ip="+ip+"&temp=" + Math.random());        $(".img_1").html(img);        $('#c').modal();        //如果图片载入失败 就在载入一次        $(".img_1 img").bind("error",function(){               var img =preloader("<php>echo __HOME__ ;</php>/index/Rimg?ip="+ip+"&temp=" + Math.random());            $(".img_1").html(img);            $("#a_1").hide();        });           $(".img_1 img").load(function(){            $("#a_1").hide();        });                $.get("<php>echo __HOME__;</php>/Sconfig/select?ip="+ip,        function(data,status){         data =  eval ("(" + data + ")");         var address = data['address'];         var reject_foreign = data['reject_foreign'];         $("#setting_address1").html(address);         $("#setting_address").val(address);        //-----------------n1-------------------//            $("#address").val(data.address);            $("#prefix").val(data.prefix);            if(data.exist=="checked"){                $("#exist").prop("checked",true);                //alert("1111");            }            if(data.force_protect=="checked"){                $("#force_protect").prop('checked', true);                //alert("1111");            }            $("#gateway_ip").val(data.gateway_ip);            $("#gateway_mac").val(data.gateway_mac);            $("#flow_incoming_bps").val(data.flow_incoming_bps);            $("#flow_outgoing_bps").val(data.flow_outgoing_bps);            $("#flow_incoming_pps").val(data.flow_incoming_pps);            $("#flow_outgoing_pps").val(data.flow_outgoing_pps);            if(data.ignore=="checked"){            $("#ignore").prop('checked',true);            }            if(data.forbid=="checked"){            $("#forbid").prop('checked',true);            }            if(data.forbid_overflow=="checked"){            $("#forbid_overflow").prop('checked',true);            }                        if(data.reject_foreign=="checked"){            $("#reject_foreign").prop('checked',true);            }            $("#param_set").val(data.param_set);            $("#filter_set").val(data.filter_set);            $("#portpro_set_tcp").val(data.portpro_set_tcp);            $("#portpro_set_udp").val(data.portpro_set_udp);        //-----------------n1 end-------------------//                if(reject_foreign=="checked"){            $("#reject_foreign").prop('checked',true);         }     });    });function preloader(url){    var heavyImage = new Image();        heavyImage.src = url;        return heavyImage;} //$('#c2').modal();$(".c2_b").click(function(){    var ip = $("#setting_address").val();    $.get("<php>echo __HOME__;</php>/index/S_details?ip="+ip,function(data){          //alert(data);         data =  eval ("(" + data + ")");        //初始化         $("#attack").text("");         $(".I_submit").text("");         $(".I_rate").text("");         var img ="<php>echo __HOME__ ;</php>/index/Rimg?ip="+ip+"&temp=" + Math.random();         $("#img1").attr('src',img);                       $("#attack_type").html("<div>"+data['attack_type']+"</div>");         if(data.hasOwnProperty('attack')){            var data1 =  data['attack'];            var num  = 0 ;            if(data['attack'].constructor==Array){            for( var i=0 ; i<data1.length ;i++){                var x = data1[i];                //alert(x['name']);                $("#attack").append("<div> "+x['name']+" : "+x['counter']+" ( "+x['percent']+"% )");                 num+=x['counter']-0;                            }                $("#attack_t span").text("共屏蔽地址 "+num+" 个");             }else{                var x =data['attack'];                $("#attack").append("<div> "+x['name']+" : "+x['counter']+" ( "+x['percent']+"% )");                 $("#attack_t span").text("共屏蔽地址 "+x['counter']+" 个");                         }                     }else{                $("#attack_t span").text("共屏蔽地址 0 个");             }         $(".I_submit").append("<div>最大输入："+ data['max_input'] +" Mbps，平均输入："+data['average_input']+" Mbps");         $(".I_submit").append("<div>最大输入提交："+data['max_input_submit']+" Mbps，平均输入提交："+ data['average_input_submit']+" Mbps");         $(".I_submit").append("<div>平均输入提交比率："+data['input_submit_percent']+" %");         $(".I_rate").append("<div> 最大TCP连接频率："+data['max_tcp_rate']+" 个/秒，平均TCP连接频率："+data['average_tcp_rate']+" 个/秒</div>");         $(".I_rate").append("<div>最大UDP连接频率："+data['max_udp_rate']+" 个/秒，平均UDP连接频率："+data['average_udp_rate']+" 个/秒</div>");          $('#c2').modal();         //alert(data['address']);    });});             </script>  </body></html>